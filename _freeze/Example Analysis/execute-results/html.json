{
  "hash": "33ae92d6b362bc3189152f8977717d82",
  "result": {
    "markdown": "---\ntitle: \"Example Analysis\"\nbibliography: reference.bib\n---\n\n\n## Introduction\n\n![](seatbelt%20image.png){width=\"50%\"}\n\n::: callout-tip\n## Seatbelt images\n\nThe above image is downloaded from website <https://www.sevenishlaw.com/blog/fewer-teenagers-wearing-seat-belts-increases-risks/>\n:::\n\n[@Seatbelts]\n\n\nMotor vehicle crashes has always been a leading cause of death throughout the world. It has been founded that wearing seat belts is a great way to prevent death or serious injury in a car crash. [@CDC] In this analysis, I would love to further explore the effect of wearing seat belts on preventing drivers and passengers' death.\n\nThe data set \"UKDriverDeaths\" is a built-in time series data set in R based on \"Road Casualties in Great Britain 1969-84\". [@Rdocumentation] It measures the monthly totals of car driver and passengers killed or seriously injured from January 1969 to December 1984. The question I am trying to answer is the effect of wearing set belts which was legislated on January 31st, 1983. Through my analysis, I want to emphasize the importance of wearing seat belts to drivers and passengers.\n\n| Variable      | Type | Missing | n   | Description                                       |\n|-------------|-------------|-------------|-------------|--------------------|\n| DriversKilled | num  | 0       | 192 | car drivers killed                                |\n| drivers       | num  | 0       | 192 | drivers                                           |\n| front         | num  | 0       | 192 | front-seat passengers killed or seriously injured |\n| rear          | num  | 0       | 192 | rear-seat passengers killed or seriously injured  |\n| kms           | num  | 0       | 192 | distance driven                                   |\n| PetrolPrice   | num  | 0       | 192 | petrol price                                      |\n| VanKilled     | num  | 0       | 192 | number of van ('light goods vehicle') drivers     |\n| law           | num  | 0       | 192 | 0/1: was the law in effect that month?            |\n\n: UKDriverDeaths Data Dictionary {tbl-colwidths=\"\\[60,25\\]\"}\n\n[@Quarto]\n\n::: column-margin\nThe link for the original UKDriverDeaths data: <https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/UKDriverDeaths.html>\n:::\n\n## Data Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# | message: false\n# | echo: false\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.1\n✔ readr   2.1.2     ✔ forcats 0.5.2\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(reshape2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'reshape2'\n\nThe following object is masked from 'package:tidyr':\n\n    smiths\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# call up \"Seatbelts\" time series data set\ndata(\"Seatbelts\")\n# convert \"Seatbelts\" time series to data frame\ndf = data.frame(as.matrix(Seatbelts), Date=time(Seatbelts))\n#\nslice_sample(df, n = 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  DriversKilled drivers front rear   kms PetrolPrice VanKilled law     Date\n1           109    1510   829  506 19453  0.12448999        10   0 1981.583\n2           125    1407   671  300 13517  0.11175347        11   0 1976.167\n3           111    1520   866  429 12926  0.09808018        13   0 1970.417\n4           119    1461   750  329 15582  0.09038292         7   0 1979.250\n5           101    1395   643  373 14417  0.10964252        10   0 1976.250\n```\n:::\n\n```{.r .cell-code}\n# subset data set\ndf$law = as.factor(df$law)\nsub1 = select(df,c(DriversKilled,law,front,rear,Date))\n# remove missing data\nsub1 = sub1 %>% drop_na(.)\n#group data set by before law and after law\n#summarize the max, min, mean, etc. by each group \nsub1 %>% \n  group_by(law) %>% \n  summarize(avg = mean(DriversKilled),\n            q1=quantile(DriversKilled,0.25), \n            q3 = quantile(DriversKilled,0.75),\n            minimum = min(DriversKilled), maximum = max(DriversKilled))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 6\n  law     avg    q1    q3 minimum maximum\n  <fct> <dbl> <dbl> <dbl>   <dbl>   <dbl>\n1 0      126.   108   140      79     198\n2 1      100.    85   119      60     154\n```\n:::\n:::\n\n\n## Graphs\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Scatterplot: Car Drivers Killed from 1969 to 1984\nggplot(sub1, aes(x=Date, y=DriversKilled, color=law)) + \n  geom_point() + theme_minimal() + \n  labs(title=\"Car Driver Killed\", subtitle = \"From 1969 to 1984\",\n       x=\"Date\",y=\"Drivers Killed\", \n       caption = \"Data source: Seatbelts\") +\n  scale_color_discrete(labels=c(\"Before Law\",\"After Law\"))\n```\n\n::: {.cell-output-display}\n![](Example-Analysis_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Box plot: Effects of Seatbelts on Drivers\nggplot(sub1, aes(x=law, y =DriversKilled, fill = law)) + \n  geom_boxplot() + theme_minimal() + \n  labs(title=\"Effects of Seatbelts on Drivers\", \n       subtitle = \"Car Drivers Mortality From 1969 to 1984\",\n       x = \"Before and After Law Introduced\",\n       y=\"Drivers Killed\", \n       caption = \"Data source: Seatbelts\") +\n  scale_fill_discrete(labels=c(\"Before Law\",\"After Law\"))\n```\n\n::: {.cell-output-display}\n![](Example-Analysis_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Bar plot: Effect of Seatbelts on Passengers\nsub2 = sub1 %>% \n  group_by(law) %>% \n  summarize(Front = sum(front),Rear = sum(rear))\nsub2melted = melt(sub2, id.var='law')\nggplot(sub2melted,aes(x=variable,y = value, fill=variable))+\n  geom_bar(stat=\"identity\",position=\"dodge\") + facet_wrap(~law) +\n  labs(title=\"Effect of Seatbelts on Passengers \", \n  subtitle = \"Car Passengers Mortality Comparison Before vs After Law\",\n        x = \"Position of Passengers\",\n       y=\"Passengers Killed\", \n       caption = \"Data source: Seatbelts\") + \n  scale_fill_discrete(name = \"Position\")\n```\n\n::: {.cell-output-display}\n![](Example-Analysis_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n:::\n\n\n## Results & Conclusions\n\nFrom the statistical summary and plots above, I can conclude that the introduction of seat belt legislation reduces the death of drivers. The average death of drivers in car crashes before implementing the law is much lower than the average mortality of drivers after implementing the law. In addition to drivers, the death or incidence of serious injury of passengers, both front and rear, is reduced. Therefore, it is beneficial for both drivers and passengers to wear seat belts to protect themselves from severe car crashes.\n\n::: callout-note\n## R Functions Used In Analysis\n\nThe dplyr functions used in the analysis include slice_sample(), select(), group_by(), summarize(), %\\>%. The tidyr function used in the analysis includes drop_na(). And the ggplot2 functions used in graphing includes geom_points(), geom_boxplot(), geom_bar().\n:::\n",
    "supporting": [
      "Example-Analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}